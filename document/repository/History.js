'use strict'

// ================================================================================
// * History <SDUDOC Document>
// --------------------------------------------------------------------------------
//   Designer: Lagomoro <Yongrui Wang>
//   License: MIT
// ================================================================================

// ================================================================================
// * Module dependencies
// --------------------------------------------------------------------------------
/**
 * Module dependencies.
 * @private
 */w
// ================================================================================

// ================================================================================
// * History
// --------------------------------------------------------------------------------
function History() {
    this.initialize.apply(this, arguments);
}
// --------------------------------------------------------------------------------
// * Constant
// --------------------------------------------------------------------------------
History.MAX_STACK = 100;
// --------------------------------------------------------------------------------
// * Property
// --------------------------------------------------------------------------------
History.prototype._left_queue = [];
History.prototype._right_queue = [];
// --------------------------------------------------------------------------------
// * Initialize & Clear
// --------------------------------------------------------------------------------
History.prototype.initialize = function(){
    this._left_queue = [];
    this._right_queue = [];
}
// --------------------------------------------------------------------------------
History.prototype.clear = function(){
    this._left_queue = [];
    this._right_queue = [];
};
// --------------------------------------------------------------------------------
// * Function
// --------------------------------------------------------------------------------
History.prototype.canUndo = function(){
    return this._left_queue.length > 0;
}
History.prototype.canRedo = function(){
    return this._right_queue.length > 0;
}
// --------------------------------------------------------------------------------
History.prototype._clearRight = function(){
    this._right_queue = [];
};
// --------------------------------------------------------------------------------
History.prototype.applyAction = function(actions){
    this._left_queue.push(actions);
    if(this._left_queue.length >= History.MAX_STACK){
        this._left_queue.shift();
    }
    this._clearRight();
}
// --------------------------------------------------------------------------------
History.prototype.undo = function(){
    if (!this.canUndo()) return null;
    let actions = this._left_queue.pop();
    this._right_queue.push(actions);
    return actions;
}
History.prototype.redo = function(){
    if (!this.canRedo()) return null;
    let actions = this._right_queue.pop();
    this._left_queue.push(actions);
    return actions;
}
// ================================================================================

// ================================================================================
// * Module exports
// --------------------------------------------------------------------------------
/**
 * Module exports.
 * @public
 */
// --------------------------------------------------------------------------------
module.exports = History;
// ================================================================================
